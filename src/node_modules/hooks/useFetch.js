import React,{useState,useEffect} from 'react';
import axios from 'axios';


export default url => {

const baseUrl = 'https://conduit.productionready.io/api/'    
const [isLoading,setIsLoading] = useState(false);
const [response,setResponse] = useState(null);
const [error,setError] = useState(null);
const [options,setOptions]= useState({});
  
const doFetch = (options={}) => {
    setOptions(options);
    setIsLoading(true);
}

useEffect(()=>{

    if(isLoading == false){
        return
    }

    console.log('triggered')
    axios(baseUrl+url,options)
    .then(res=>{
        console.log(res);
        setResponse(res.data);
        setIsLoading(false);
    })
    .catch(err=>{
        console.log(err)
        setError(err.response.data);
        setIsLoading(false)
    })

   
},[isLoading])

return [{isLoading, response, error},doFetch]
    
}